@{
    ViewData["Title"] = "Dashboard";
}

<main class="flex-grow p-4 sm:p-6 lg:p-8 max-w-[1400px] mx-auto w-full">
        
        <!-- Cabeçalho de Boas Vindas -->
        <div class="mb-8">
            <h1 class="text-3xl font-bold text-white">Olá, @ViewBag.userName</h1>
            <p class="text-slate-400">Aqui está o resumo do seu treino de hoje.</p>
        </div>

        <!-- Grid de Estatísticas (KPIs) -->
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-8">
            <!-- Card 1 -->
            <div class="glass-card rounded-xl p-5 flex flex-col items-center justify-center hover:border-emerald-500/50 transition duration-300">
                <span class="text-3xl font-bold text-emerald-400" id="totalExercises">4</span>
                <span class="text-xs uppercase tracking-wider text-slate-400 font-semibold mt-1">Exercícios Hoje</span>
            </div>
            <!-- Card 2 -->
            <div class="glass-card rounded-xl p-5 flex flex-col items-center justify-center hover:border-emerald-500/50 transition duration-300">
                <span class="text-3xl font-bold text-blue-400">3.2</span>
                <span class="text-xs uppercase tracking-wider text-slate-400 font-semibold mt-1">Tonelagem (Ton)</span>
            </div>
            <!-- Card 3 -->
            <div class="glass-card rounded-xl p-5 flex flex-col items-center justify-center hover:border-emerald-500/50 transition duration-300">
                <span class="text-3xl font-bold text-orange-400">28</span>
                <span class="text-xs uppercase tracking-wider text-slate-400 font-semibold mt-1">Dias Consecutivos</span>
            </div>
            <!-- Card 4 -->
            <div class="glass-card rounded-xl p-5 flex flex-col items-center justify-center hover:border-emerald-500/50 transition duration-300">
                <span class="text-3xl font-bold text-purple-400">+5.2%</span>
                <span class="text-xs uppercase tracking-wider text-slate-400 font-semibold mt-1">Progresso Semanal</span>
            </div>
        </div>

        <!-- Layout Principal: 2 Colunas (Esquerda Larga / Direita Estreita) -->
        <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
            
            <!-- Coluna Esquerda (Lista e Gráficos) - Ocupa 8 colunas -->
            <div class="lg:col-span-8 space-y-6">
                
                <!-- Lista de Exercícios de Hoje -->
                <div class="glass-card rounded-xl overflow-hidden">
                    <div class="px-6 py-4 border-b border-slate-700 flex justify-between items-center bg-slate-800/50">
                        <h2 class="font-semibold text-lg flex items-center gap-2">
                            <i class="fa-solid fa-list-check text-emerald-500"></i> Exercícios de Hoje
                        </h2>
                        <span class="text-xs bg-emerald-900/50 text-emerald-400 px-2 py-1 rounded border border-emerald-900">17 Dez 2025</span>
                    </div>

                    <div id="workoutList" class="p-6 space-y-4">
                        
                        <!-- Item 1 -->
                        <div class="bg-slate-900/50 border border-slate-700 rounded-lg p-4 flex flex-col sm:flex-row justify-between items-center relative overflow-hidden group hover:border-emerald-500/30 transition">
                            <div class="absolute left-0 top-0 bottom-0 w-1 bg-emerald-500"></div> <!-- Borda Colorida Lateral -->
                            
                            <div class="flex items-center gap-4 w-full sm:w-auto mb-3 sm:mb-0">
                                <div class="h-10 w-10 rounded-full bg-slate-800 flex items-center justify-center text-emerald-500 border border-slate-700">
                                    <i class="fa-solid fa-dumbbell"></i>
                                </div>
                                <div>
                                    <h3 class="font-bold text-white text-lg">Supino Reto</h3>
                                    <p class="text-sm text-slate-400">3 séries • 12 repetições • <span class="text-emerald-400 text-xs">+2kg</span></p>
                                </div>
                            </div>

                            <div class="flex items-center gap-6">
                                <div class="text-right">
                                    <span class="block text-2xl font-bold text-emerald-400">50 <span class="text-sm text-slate-500">kg</span></span>
                                </div>
                                <button class="text-slate-500 hover:text-white p-2 rounded-md hover:bg-slate-700 transition">
                                    <i class="fa-regular fa-pen-to-square"></i>
                                </button>
                            </div>
                        </div>

                        <!-- Item 2 -->
                        <div class="bg-slate-900/50 border border-slate-700 rounded-lg p-4 flex flex-col sm:flex-row justify-between items-center relative overflow-hidden group hover:border-emerald-500/30 transition">
                            <div class="absolute left-0 top-0 bottom-0 w-1 bg-blue-500"></div>
                            
                            <div class="flex items-center gap-4 w-full sm:w-auto mb-3 sm:mb-0">
                                <div class="h-10 w-10 rounded-full bg-slate-800 flex items-center justify-center text-blue-500 border border-slate-700">
                                    <i class="fa-solid fa-person-running"></i>
                                </div>
                                <div>
                                    <h3 class="font-bold text-white text-lg">Agachamento Livre</h3>
                                    <p class="text-sm text-slate-400">4 séries • 10 repetições • <span class="text-emerald-400 text-xs">+5kg</span></p>
                                </div>
                            </div>

                            <div class="flex items-center gap-6">
                                <div class="text-right">
                                    <span class="block text-2xl font-bold text-blue-400">80 <span class="text-sm text-slate-500">kg</span></span>
                                </div>
                                <button class="text-slate-500 hover:text-white p-2 rounded-md hover:bg-slate-700 transition">
                                    <i class="fa-regular fa-pen-to-square"></i>
                                </button>
                            </div>
                        </div>

                        <!-- Item 3 -->
                        <div class="bg-slate-900/50 border border-slate-700 rounded-lg p-4 flex flex-col sm:flex-row justify-between items-center relative overflow-hidden group hover:border-emerald-500/30 transition">
                            <div class="absolute left-0 top-0 bottom-0 w-1 bg-purple-500"></div>
                            
                            <div class="flex items-center gap-4 w-full sm:w-auto mb-3 sm:mb-0">
                                <div class="h-10 w-10 rounded-full bg-slate-800 flex items-center justify-center text-purple-500 border border-slate-700">
                                    <i class="fa-solid fa-child-reaching"></i>
                                </div>
                                <div>
                                    <h3 class="font-bold text-white text-lg">Leg Press</h3>
                                    <p class="text-sm text-slate-400">4 séries • 12 repetições • <span class="text-yellow-500 text-xs">Mantido</span></p>
                                </div>
                            </div>

                            <div class="flex items-center gap-6">
                                <div class="text-right">
                                    <span class="block text-2xl font-bold text-purple-400">120 <span class="text-sm text-slate-500">kg</span></span>
                                </div>
                                <button class="text-slate-500 hover:text-white p-2 rounded-md hover:bg-slate-700 transition">
                                    <i class="fa-regular fa-pen-to-square"></i>
                                </button>
                            </div>
                        </div>

                    </div>
                </div>

                <!-- Seção de Análise de Progresso -->
                <div class="glass-card rounded-xl p-6">
                    <h2 class="font-semibold text-lg flex items-center gap-2 mb-4">
                        <i class="fa-solid fa-chart-line text-blue-500"></i> Progresso no Supino
                    </h2>
                    
                    <div class="flex justify-between items-end mb-2">
                        <div>
                            <p class="text-sm text-slate-400">Peso Máximo Atual</p>
                            <p class="text-2xl font-bold text-white">52.5 kg</p>
                        </div>
                        <div class="text-right">
                            <p class="text-sm text-slate-400">Meta</p>
                            <p class="text-2xl font-bold text-white">60 kg</p>
                        </div>
                    </div>
                    
                    <!-- Barra de Progresso Customizada -->
                    <div class="w-full bg-slate-700 rounded-full h-4 relative overflow-hidden">
                        <div class="bg-gradient-to-r from-blue-600 to-blue-400 h-4 rounded-full" style="width: 87%;">
                            <div class="w-full h-full opacity-30" style="background-image: linear-gradient(45deg,rgba(255,255,255,.15) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.15) 75%,transparent 75%,transparent); background-size: 1rem 1rem;"></div>
                        </div>
                    </div>
                    <p class="text-xs text-emerald-400 mt-2 font-medium">Você está +2.5kg acima da sua última semana. Continue assim!</p>
                </div>
            </div>

            <!-- Coluna Direita (Formulário e Histórico) - Ocupa 4 colunas -->
            <div class="lg:col-span-4 space-y-6">
                
                <!-- Formulário "Adicionar Exercício" -->
                <div class="glass-card rounded-xl p-6 sticky top-24">
                    <h2 class="font-bold text-lg text-white mb-4 flex items-center gap-2">
                        <i class="fa-solid fa-circle-plus text-emerald-500"></i> Adicionar Exercício
                    </h2>
                    
                    <form id="addForm" class="space-y-4">
                        <div>
                            <label class="block text-xs font-medium text-slate-400 mb-1">Exercício</label>
                            <select id="name-add" name="name-add" class="w-full bg-slate-900 border border-slate-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:border-emerald-500 focus:ring-1 focus:ring-emerald-500 transition">
                                <option>Selecione um exercício</option>
                                <option>Supino Reto</option>
                                <option>Supino Inclinado</option>
                                <option>Agachamento Livre</option>
                                <option>Levantamento Terra</option>
                                <option>Rosca Direta</option>
                            </select>
                        </div>

                        <div class="grid grid-cols-2 gap-3">
                            <div>
                                <label class="block text-xs font-medium text-slate-400 mb-1">Peso (kg)</label>
                                <input type="number" id="weight-add" name="weight-add" class="w-full bg-slate-900 border border-slate-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:border-emerald-500 transition" placeholder="Ex: 50">
                            </div>
                            <div>
                                <label class="block text-xs font-medium text-slate-400 mb-1">Repetições</label>
                                <input type="number" id="reps-add" name="reps-add" class="w-full bg-slate-900 border border-slate-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:border-emerald-500 transition" placeholder="Ex: 12">
                            </div>
                        </div>

                        <div class="grid grid-cols-2 gap-3">
                            <div>
                                <label class="block text-xs font-medium text-slate-400 mb-1">Séries</label>
                                <input type="number" id="series-add" name="series-add" class="w-full bg-slate-900 border border-slate-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:border-emerald-500 transition" placeholder="Ex: 3">
                            </div>
                            <div>
                                <label class="block text-xs font-medium text-slate-400 mb-1">Descanso (min)</label>
                                <input type="number" id="rest-add" name="rest-add" class="w-full bg-slate-900 border border-slate-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:border-emerald-500 transition" placeholder="Ex: 2">
                            </div>
                        </div>

                        <div>
                            <label class="block text-xs font-medium text-slate-400 mb-1">Observações (opcional)</label>
                            <textarea id="obs-add" name="obs-add" class="w-full bg-slate-900 border border-slate-700 rounded-lg px-4 py-2 text-white text-sm focus:outline-none focus:border-emerald-500 transition h-20 resize-none" placeholder="Fiz com ajuda no último set..."></textarea>
                        </div>

                        <button type="submit" class="w-full bg-emerald-600 hover:bg-emerald-500 text-white font-bold py-3 rounded-lg shadow-lg shadow-emerald-900/50 transition duration-200 flex justify-center items-center gap-2">
                            <i class="fa-solid fa-save"></i> Salvar Exercício
                        </button>
                    </form>
                </div>

                <!-- Treinos Recentes -->
                <div class="glass-card rounded-xl p-6">
                    <h2 class="font-semibold text-lg text-white mb-4 flex items-center gap-2">
                        <i class="fa-solid fa-history text-slate-400"></i> Treinos Recentes
                    </h2>

                    <div class="space-y-4">
                        <!-- Item Histórico 1 -->
                        <div class="border-l-2 border-emerald-500 pl-4 py-1">
                            <div class="flex justify-between items-start">
                                <h4 class="font-bold text-white text-sm">Peito e Tríceps</h4>
                                <span class="text-xs text-slate-500">Ontem</span>
                            </div>
                            <p class="text-xs text-slate-400 mt-1">Supino: 48 kg • 6 exercícios</p>
                            <div class="w-full bg-slate-700 h-1.5 rounded-full mt-2">
                                <div class="bg-emerald-500 h-1.5 rounded-full" style="width: 80%"></div>
                            </div>
                        </div>

                        <!-- Item Histórico 2 -->
                        <div class="border-l-2 border-blue-500 pl-4 py-1">
                            <div class="flex justify-between items-start">
                                <h4 class="font-bold text-white text-sm">Pernas</h4>
                                <span class="text-xs text-slate-500">15 Dez</span>
                            </div>
                            <p class="text-xs text-slate-400 mt-1">Agachamento: 75 kg • 5 exercícios</p>
                            <div class="w-full bg-slate-700 h-1.5 rounded-full mt-2">
                                <div class="bg-blue-500 h-1.5 rounded-full" style="width: 60%"></div>
                            </div>
                        </div>

                        <!-- Item Histórico 3 -->
                        <div class="border-l-2 border-purple-500 pl-4 py-1">
                            <div class="flex justify-between items-start">
                                <h4 class="font-bold text-white text-sm">Costas e Bíceps</h4>
                                <span class="text-xs text-slate-500">13 Dez</span>
                            </div>
                            <p class="text-xs text-slate-400 mt-1">Barra Fixa: 70 kg • 7 exercícios</p>
                            <div class="w-full bg-slate-700 h-1.5 rounded-full mt-2">
                                <div class="bg-purple-500 h-1.5 rounded-full" style="width: 90%"></div>
                            </div>
                        </div>
                    </div>
                    
                    <button class="w-full mt-4 text-xs text-slate-400 hover:text-white border border-slate-700 hover:bg-slate-700 p-2 rounded transition">
                        Ver histórico completo
                    </button>
                </div>

            </div>
        </div>
    </main>

<!-- Scripts Específicos desta página -->
@section Scripts {
    <script>
        $(document).ready(function() {
            
            $("<style>.animate-entry { animation: slideDown 0.4s ease-out forwards; } @@keyframes slideDown { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }</style>").appendTo("head");
            GetExercises();
            $('#addForm').on('submit', function(e) {
                debugger
                e.preventDefault();
                let name = $('#name-add').val();
                let weight = $('#weight-add').val();
                let reps = $('#reps-add').val();
                let series = $('#series-add').val();
                let rest = $('#rest-add').val();
                let obs = $('#obs-add').val();


                $.ajax({
                    url: '/Home/CreateExercise',
                    type: 'POST',
                    data: {
                        name: name,
                        weight: weight,
                        reps: reps,
                        series: series,
                        rest: rest,
                        obs: obs,
                        @* order: order, *@
                    },
                    success: function(response) {
                        if (response.success) {
                            let html = `
                                <div class="animate-entry bg-slate-900/50 border border-slate-700 rounded-lg p-4 flex flex-col sm:flex-row justify-between items-center relative overflow-hidden group hover:border-emerald-500/30 transition mb-4">
                                    <div class="absolute left-0 top-0 bottom-0 w-1 bg-emerald-500"></div>
                                    <div class="flex items-center gap-4 w-full sm:w-auto mb-3 sm:mb-0">
                                        <div class="h-10 w-10 rounded-full bg-slate-800 flex items-center justify-center text-emerald-500 border border-slate-700"><i class="fa-solid fa-dumbbell"></i></div>
                                        <div><h3 class="font-bold text-white text-lg">${response.data.name}</h3><p class="text-sm text-slate-400">${response.data.series} séries • ${response.data.reps} repetições</p></div>
                                    </div>
                                    <div class="flex items-center gap-6">
                                        <span class="block text-2xl font-bold text-emerald-400">${response.data.weight} <span class="text-sm text-slate-500">kg</span></span>
                                        <button class="delete-btn text-slate-500 hover:text-red-500 p-2 rounded-md hover:bg-slate-700 transition"><i class="fa-solid fa-trash-can"></i></button>
                                    </div>
                                </div>`;
                            
                            $('#workoutList').prepend(html);
                            let count = parseInt($('#totalExercises').text()) + 1;
                            $('#totalExercises').text(count);
                            this.reset();
                        } else {
                            alert(response.message); 
                        }
                    },
                    error: function(xhr, status, error) {
                        alert('Ocorreu um erro ao registrar: ' + error);
                    }
                });

                
            });

            $(document).on('click', '.delete-btn', function() {
                $(this).closest('.group').slideUp(300, function() { $(this).remove(); });
            });
        });

        function GetExercises() {
            $.ajax({
                url: '/Home/GetExercises',
                type: 'GET',
                success: function (response) {
                    if (response.success) {

                        $('#workoutList').html(''); // limpa antes

                        response.data.forEach(ex => {

                            let html = `
                                <div class="animate-entry bg-slate-900/50 border border-slate-700 rounded-lg p-4 flex flex-col sm:flex-row justify-between items-center relative overflow-hidden group hover:border-emerald-500/30 transition mb-4">
                                    
                                    <div class="absolute left-0 top-0 bottom-0 w-1 bg-emerald-500"></div>

                                    <div class="flex items-center gap-4 w-full sm:w-auto mb-3 sm:mb-0">
                                        <div class="h-10 w-10 rounded-full bg-slate-800 flex items-center justify-center text-emerald-500 border border-slate-700">
                                            <i class="fa-solid fa-dumbbell"></i>
                                        </div>

                                        <div>
                                            <h3 class="font-bold text-white text-lg">${ex.name}</h3>
                                            <p class="text-sm text-slate-400">
                                                ${ex.series} séries • ${ex.reps} repetições
                                            </p>
                                        </div>
                                    </div>

                                    <div class="flex items-center gap-6">
                                        <span class="block text-2xl font-bold text-emerald-400">
                                            ${ex.weight ?? 0}
                                            <span class="text-sm text-slate-500">kg</span>
                                        </span>

                                        <button class="delete-btn text-slate-500 hover:text-red-500 p-2 rounded-md hover:bg-slate-700 transition"
                                                data-id="${ex.id}">
                                            <i class="fa-solid fa-trash-can"></i>
                                        </button>
                                    </div>
                                </div>
                            `;

                            $('#workoutList').append(html);
                        });

                        $('#totalExercises').text(response.data.length);
                    }
                    else {
                        alert(response.message);
                    }
                },
                error: function (xhr, status, error) {
                    alert('Erro ao buscar exercícios: ' + error);
                }
            });
        }

    </script>
}